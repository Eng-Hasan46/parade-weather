export async function geocodeCity(q, lang='en'){if(!q||q.trim().length<2)return[];const url=`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(q)}&count=5&language=${lang}&format=json`;const res=await fetch(url);const data=await res.json();return (data.results||[]).map(r=>({name:`${r.name}${r.admin1?', '+r.admin1:''}${r.country?', '+r.country:''}`,lat:r.latitude,lon:r.longitude}));}
export async function getForecast(lat,lon){const url=`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&hourly=temperature_2m,apparent_temperature,precipitation_probability,uv_index,wind_speed_10m&daily=temperature_2m_max,temperature_2m_min,uv_index_max,precipitation_probability_max&timezone=auto`;const res=await fetch(url);if(!res.ok)throw new Error('Failed to fetch forecast');return res.json();}